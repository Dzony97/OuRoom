{% extends "rooms/mainroom.html" %}
{% block content %}

    <div class="posts-container">
        <article class="media content-section">

            {% if post.author == user %}
                <a href="{% url 'post_update' post.id %}" class="post-link"><i class="fa-solid fa-pen"></i></a>
                <a href="{% url 'post_delete' post.id %}" class="post-link"><i class="fa-solid fa-trash"></i></a>
            {% endif %}

            {% if post.image %}
            <p><img src="{{ post.image.url }}" class="post-image"></p>
            {% endif %}

            <p>{{ object.author }}</p>
            <p>{{ object.time_release|date:"F d, Y, H:i" }}</p>
            <p>{{ object.content }}</p>

            <form method="POST" action="{% url 'post_like' post.pk %}" class="like-form" data-post-id="{{ post.pk }}">

                {% csrf_token %}
                <input type="hidden" name="next" value="{{ request.path }}">
                <button type="submit" value="{{ post.pk }}">
                    <i id="like-icon-{{ post.pk }}" class="{% if request.user in post.like.all %}fa-regular{% else %}fa-solid{% endif %} fa-thumbs-up"></i><span id="like-count-{{ post.pk }}">{{ post.like.all.count }} </span>
                </button>

            </form>

        </article>
    </div>

   <div class="add-comment">

        <form method="POST" action="{% url 'comment_post' post.pk%}" class="comment-form">

            {% csrf_token %}
            {{ commentform.as_p }}

            <button type="submit" >Submit</button>

        </form>
   </div>

    <div class="comments-list">
        {% for comment in post.comments.all %}
            <div class="comment-item">
                <div class="comment-author-time">
                    <a>{{ comment.author }} {{ comment.time_release }}</a>
                    <a href="{% url 'comment_delete' comment.id %}"><i class="fa-solid fa-delete-left"></i></a>
                </div>
                <div class="comment-content">
                    <p>{{ comment.content }}</p>
                </div>
            </div>
        {% endfor %}
    </div>


{% endblock content %}